<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on MÃ­rian Bruckschen Motta Barros&#39;s Website</title>
        <link>https://mirianbr.com/posts/</link>
        <description>Recent content in Posts on MÃ­rian Bruckschen Motta Barros&#39;s Website</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Tue, 05 Oct 2021 00:00:00 +0000</lastBuildDate>
        <atom:link href="https://mirianbr.com/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Ludum Dare 49 and Interactive Fiction</title>
            <link>https://mirianbr.com/posts/2021-10-05-ludum_dare_and_interactive_fiction/</link>
            <pubDate>Tue, 05 Oct 2021 00:00:00 +0000</pubDate>
            
            <guid>https://mirianbr.com/posts/2021-10-05-ludum_dare_and_interactive_fiction/</guid>
            <description>This weekend I participated for the very first time in the Ludum Dare game jam, with my also first interactive fiction piece, and I have to say, I loved both experiences. OK, not so much the deadline pressure, but I had made a good schedule planning, and could follow it most of the time.
Until a few days ago, I didn&amp;rsquo;t know anything about interactive fiction. My husband told me I would like it when I said I was looking for enrolling in Ludum Dare this time, maybe with something low code, to do some educational game or something.</description>
            <content type="html"><![CDATA[<p>This weekend I participated for the very first time in the <a href="https://ldjam.com/">Ludum Dare game jam</a>, with my also first interactive fiction piece, and I have to say, I loved both experiences. OK, not so much the deadline pressure, but I had made a good schedule planning, and could follow it most of the time.</p>
<p><img src="https://media.giphy.com/media/l4EpblDY4msVtKAOk/giphy.gif" alt="I did it!"></p>
<p>Until a few days ago, I didn&rsquo;t know anything about interactive fiction. My husband told me I would like it when I said I was looking for enrolling in Ludum Dare this time, maybe with something low code, to do some educational game or something. He didn&rsquo;t have any experience with the tools themselves, but listed to me <a href="https://twinery.org/">Twine</a>, <a href="https://www.renpy.org/">Ren&rsquo;Py</a>, <a href="http://inform7.com/">Inform</a> and a few others that people use to create visual novels and/or interactive fiction.</p>
<p>After playing with Twine and Ren&rsquo;Py for a few minutes to an hour, I decided to go for Twine this time. I used <a href="twinery.org/">Twine</a> and <a href="https://www.motoslave.net/sugarcube/2/docs/">Sugarcube 2</a>, with some CSS tweaks &ndash; but it&rsquo;s mostly Sugarcube macros only. This library is so powerful &ndash; and fun to create with!</p>
<p>Most of the time, I feel most of the tools I use or learn currently get a lot in the way of accomplishing things. And Twine+Sugarcube felt something else completely: I wanted to create a story, create loops, create endings, and they made it very simple to do it. When audio effects came in, then not so much, but even so &ndash; things made sense, were consistent. There was no noise in the documentation, examples, etc.</p>
<p>When the <a href="https://ldjam.com/events/ludum-dare/49/">jam theme came out on Friday evening</a>, I had this maybe a little obvious idea, and there was nothing educational about it. But I had a blast. I didn&rsquo;t even expect to like it that much. I loved both creating the story and its branches/possibilities/endings (interactively, as I progressed in my short day-sprints) as having a theme to think over and create it in the first place.</p>
<p><img src="https://media.giphy.com/media/cstHEo3umAADEfFAvZ/giphy.gif" alt="I love it!"></p>
<p>At the end of the first complete day I had a (boring) playable version; at the end of Sunday I had a better one (with graphics and some audio); and finally some hours from the deadline on Monday I had a version I was happy to share &ndash; and a lot of other ideas documented (more like &ldquo;Future works&rdquo; than TODOs, actually), of course.</p>
<h2 id="play-it">Play it!</h2>
<p>There is no chance you&rsquo;ll enjoy playing my piece as much as I enjoyed doing it, but here it is anyway: you can <a href="https://mirianbr.itch.io/asylum">play it online on itch.io</a>.</p>
<p>And this is <a href="https://ldjam.com/events/ludum-dare/49/asylum">my game page in LD game jam</a>.</p>
<p><img src="https://raw.githubusercontent.com/mirianbr/asylum/main/screenshots/ld-screenshot.png" alt="A screenshot of Asylum, my interactive fiction piece for Ludum Dare 49."></p>
<p>Drop me a note if you liked my story (or if you didn&rsquo;t, but played it anyway). I&rsquo;d love to hear what you think!</p>
<h2 id="download-and-play-with-it">Download and play with it!</h2>
<p>The HTML (and associated media) is on <a href="https://github.com/mirianbr/asylum">github</a>, and you can just download it and open in Twine. (Twine is so great, did I say this already?)</p>
<p><img src="https://media.giphy.com/media/3NhDtlwC13xh8HVCMj/giphy.gif" alt="I REALLY loved it!"></p>
]]></content>
        </item>
        
        <item>
            <title>A pytesseract hello world in Portuguese under Anaconda</title>
            <link>https://mirianbr.com/posts/2021-07-13-pytesseract_hello_world_in_portuguese_under_anaconda/</link>
            <pubDate>Tue, 13 Jul 2021 00:00:00 +0000</pubDate>
            
            <guid>https://mirianbr.com/posts/2021-07-13-pytesseract_hello_world_in_portuguese_under_anaconda/</guid>
            <description>Playing with OCR using python for the first time, I came across tesseract and its Python wrapper, pytesseract. I started by (and recommend) this detailed tutorial, that covers the tesseract and pytesseract installation, assuming you already have Anaconda.
Forcing the tessdata-dir to be found Depending on your installation, though, things may not work at first. Mine didn&amp;rsquo;t, for the tessdata-dir wasn&amp;rsquo;t being found (Error opening data file... error). In order to resolve this, I followed pytesseract usage hint to force the tessdata directory:</description>
            <content type="html"><![CDATA[<p>Playing with OCR using python for the first time, I came across <a href="https://github.com/tesseract-ocr/tesseract">tesseract</a> and its Python wrapper, <a href="https://pypi.org/project/pytesseract/">pytesseract</a>. I started by (and recommend) <a href="https://pythonforundergradengineers.com/how-to-install-pytesseract.html">this detailed tutorial</a>, that covers the tesseract and pytesseract installation, assuming you already have Anaconda.</p>
<h2 id="forcing-the-tessdata-dir-to-be-found">Forcing the tessdata-dir to be found</h2>
<p>Depending on your installation, though, things may not work at first. Mine didn&rsquo;t, for the tessdata-dir wasn&rsquo;t being found (<code>Error opening data file...</code> error). In order to resolve this, I followed <a href="https://pypi.org/project/pytesseract/">pytesseract usage hint</a> to force the tessdata directory:</p>
<ol>
<li>Find the tessdata directory in my local installation</li>
<li>Create a <a href="https://docs.python.org/3.3/reference/lexical_analysis.html?highlight=string%20literals#string-and-bytes-literals">literal string variable</a> (prefixed by <code>r'</code>) to store the directory path, so your backslashes are interpreted literally</li>
<li>Use this string when calling image_to_string in the <code>config</code> parameter</li>
</ol>
<p>See my code snippet below:</p>
<pre tabindex="0"><code>tessdata_dir_config = r'--tessdata-dir &quot;C:\Users\miria\anaconda3\envs\tesseract\Library\bin\tessdata&quot;'
phrase = ocr.image_to_string(Image.open('oi.jpeg'), config=tessdata_dir_config)
</code></pre><h2 id="failed-loading-language-por-tesseract-couldnt-load-any-languages">Failed loading language &lsquo;por&rsquo;, Tesseract couldn&rsquo;t load any languages!</h2>
<p>If you want to use tesseract to read texts from images that are not in English (in my case, it&rsquo;s Portuguese), have in mind Anaconda may not have installed your target language.</p>
<p>My English tutorials worked, but not other languages (<a href="https://github.com/tesseract-ocr/tesseract/blob/master/doc/tesseract.1.asc#languages">announced to be supported</a>). Every time, I got the error below:</p>
<pre tabindex="0"><code>TesseractError: (1, 'Error opening data file &lt;your tessdata dir&gt;/por.traineddata 
  Please make sure the TESSDATA_PREFIX environment variable is set to your &quot;tessdata&quot; directory. 
  Failed loading language 'por' 
  Tesseract couldn't load any languages! 
  Could not initialize tesseract.')
</code></pre><p>The <code>couldn't load any languages</code> part led me to find the same answers as the previous section &ndash; forcing the tessdata-dir configuration. Except it didn&rsquo;t happen for English.</p>
<p>The relevant part of the error message was the <code>language 'por'</code>: tesseract didn&rsquo;t have Portuguese data. Understanding the error was much harder than the resolution:</p>
<ol>
<li>Download your language data from the <a href="https://github.com/tesseract-ocr/tessdata/">tesseract repository</a></li>
<li>Save it in your tessdata directory</li>
</ol>
<p>All done!</p>
<p>Having the config and data set up, OCR with tesseract in Portuguese worked great. See how in <a href="https://github.com/mirianbr/vaccine-batches/blob/main/hello-ocr.ipynb">my Jupyter Notebook for this tutorial</a>. ðŸ˜‰</p>
]]></content>
        </item>
        
        <item>
            <title>USD-BRL exchange rates in Google Sheets and Excel</title>
            <link>https://mirianbr.com/posts/2021-07-09-usd-brl-exchange-rates-in-google-sheets-and-excel/</link>
            <pubDate>Fri, 09 Jul 2021 00:00:00 +0000</pubDate>
            
            <guid>https://mirianbr.com/posts/2021-07-09-usd-brl-exchange-rates-in-google-sheets-and-excel/</guid>
            <description>Doing taxes can be a challenge. If you receive money in a foreign currency, being a Brazil resident, income tax it is definitively tricky.
If you receive money from abroad, you need to do some math each month to learn what is the amount you should consider when calculating your taxes. Regardless of the currency your money is in, you need to convert it first to US dollars, then to Brazilian Reais (BRL), and just then you can do your tax calculation.</description>
            <content type="html"><![CDATA[<p>Doing taxes can be a challenge. If you receive money in a foreign currency, being a Brazil resident, income tax it is definitively tricky.</p>
<p>If you receive money from abroad, you need to do some math each month to learn what is the amount you should consider when calculating your taxes. Regardless of the currency your money is in, you need to convert it first to US dollars, then to Brazilian Reais (BRL), and just then you can do your tax calculation. But the USD-BRL conversion needs to use the exchange rate for (follow me if you can!) the last business day of the first fortnight of the month prior to the payment month.</p>
<p><img src="https://media.giphy.com/media/WRQBXSCnEFJIuxktnw/giphy.gif" alt="Woman looking confused, math formulas all around her"></p>
<p>Here I detail my experiments to create a step by step sheet document (using Google sheets and Excel), to not need to think this through every month.</p>
<p><img src="https://media.giphy.com/media/tBn5FJVUdeMarcl3gQ/giphy.gif" alt="Fun-looking blond girl gesturing a lot, subtitle says &ldquo;getting very excited about numbers and things&rdquo;"></p>
<h2 id="google-sheets">Google sheets</h2>
<p>We have 4 logical steps to find the date. Remember the definition: the exchange rate to be used is for &ldquo;the last business day of the first fortnight of the month prior to the payment month&rdquo;. Once we have the payment date (that you need to enter), let&rsquo;s follow the steps below:</p>
<ol>
<li>Find the payment month, using a creative <a href="https://support.google.com/docs/answer/3093044">EOMONTH</a> (&ldquo;End of Month&rdquo;)</li>
<li>Find the month prior to the payment month, also with <code>EOMONTH</code></li>
<li>Find the first fortnight of the month prior to the payment month (formally an interval of 14 days, but what is meant here is &ldquo;first half of the month&rdquo;), adding 15 days to the date in the previous step</li>
<li>Find the last business day of the first fortnight of the month prior to the payment month, checking for holidays and then using <a href="https://support.google.com/docs/answer/3092985">WEEKDAY</a> with the second parameter as <code>2</code>, starting weeks with Monday and thus having Saturday and Sunday easy to spot with an <code>IF</code> clause</li>
</ol>
<p>Of course all of this can be done in one step only, but it would be harder to follow. Since my purpose here was to keep some clarity (i.e., where do these dates come from?), I chose to show all the steps, despite the last date is the date we need.</p>
<p><img src="https://media.giphy.com/media/xT5LMRBvRxAHZfQh5m/giphy.gif" alt="Homer Simpson dressed funny saying &ldquo;Hmm I understand&rdquo;. I wonder if he did."></p>
<p><del>An additional note: I haven&rsquo;t considered holidays, so if the last business day of the first fortnight ends up in a holiday this won&rsquo;t work. One example is the Carnival 2021, that was celebrated in Brazil in the Monday, February 14th and Tuesday, February 15th. The thing is you can set your own manual date here (which would be February 12th), while I think of better ways.</del></p>
<p><strong>UPDATE</strong> (as of September 20th, 2021): Listed holidays are considered now.</p>
<p>We have done all this just to find the date. Now we need the exchange rate for it. For income tax purposes in Brazil, we cannot use the beautiful, easy <a href="https://support.google.com/docs/answer/3093281">GOOGLEFINANCE</a> function to get the rates data, for it needs to be the official exchange rate data provided by the Central Bank of Brazil. This exchange rate is not the last exchange rate of any given day, but an average of several exchange rates during that day, extracted from bidding agents in 4 time windows. In <a href="https://www.bcb.gov.br/en/financialstability/quotations">this page</a> there&rsquo;s a footnote describing how this is calculated.</p>
<p>Therefore we need to use the official sources. Fine. To find the rates, here I used <a href="https://support.google.com/docs/answer/3093335">IMPORTDATA</a> and <a href="https://support.google.com/docs/answer/3093343">QUERY</a> with the CSV provided by the Bank. At the time I created the first version of these documents, I couldn&rsquo;t find any API to retrieve this data (now <a href="https://dadosabertos.bcb.gov.br/dataset/dolar-americano-usd-todos-os-boletins-diarios/resource/ae69aa94-4194-45a6-8bae-12904af7e176">there is</a>, looking forward to using it shortly!).</p>
<p><strong>UPDATE</strong> (as of September 20th, 2021): Holidays are considered when listed; I&rsquo;m using <a href="https://support.google.com/docs/answer/3093378?hl=en">MATCH</a> combined with <a href="https://support.google.com/docs/answer/3093349?hl=en">ISERROR</a>, as instructed <a href="https://webapps.stackexchange.com/questions/42340/how-to-check-if-value-is-in-range-of-cells">here</a>.</p>
<p>Here you can see the <a href="https://docs.google.com/spreadsheets/d/10etG8UfcckcIpKI3-X6ax2fjx2JqA-qLJxRvTGQJcVI/edit#gid=0">resulting Google sheets document</a> (<a href="https://docs.google.com/spreadsheets/d/1Mnl46zcJlEgwFFuqP4HLeLn5cdeQyuv0Ifm0Pq5eBXY/edit#gid=0">pt-BR version</a>).</p>
<h2 id="microsoft-excel">Microsoft Excel</h2>
<p>In Excel, the same steps apply - and some of the functions even have the same name!</p>
<p>Have the payment date entered, and let&rsquo;s follow together the steps to get the date for the exchange rate:</p>
<ol>
<li>Find the payment month, using a creative <a href="https://support.microsoft.com/en-us/office/eomonth-function-7314ffa1-2bc9-4005-9d66-f49db127d628">EOMONTH</a></li>
<li>Find the month prior to the payment month, also with <code>EOMONTH</code></li>
<li>Find the first fortnight of the month prior to the payment month, only by adding 15 days to the date in the previous step</li>
<li>Find the last business day of the first fortnight of the month prior to the payment month, using the listed holidays and then the <a href="https://support.microsoft.com/en-us/office/weekday-function-60e44483-2ed1-439f-8bd0-e404c190949a">WEEKDAY</a> function with the second parameter as <code>2</code>, starting weeks with Monday and thus having Saturday and Sunday easy to spot with an <code>IF</code> clause</li>
</ol>
<p><del>In Excel too I haven&rsquo;t considered holidays. Beware of Carnival, November 15th (Republic Day in Brazil) and so many others I may be forgetting.</del></p>
<p><strong>UPDATE</strong> (as of September 20th, 2021): Listed holidays are now considered using the <a href="https://support.microsoft.com/en-us/office/match-function-e8dffd45-c762-47d6-bf89-533f4a37673a">MATCH</a> + <a href="https://support.microsoft.com/en-us/office/is-functions-0f2d7971-6019-40a0-a171-f2d869135665">ISERROR</a> (not ISERR!) functions. In Portuguese-translated Excel, these functions are called CORRESP (for MATCH) and Ã‰ERROS (for ISERROR).</p>
<p>The dates above can be used to forge an URL to extract CSV data from, that will look like something this: <a href="https://ptax.bcb.gov.br/ptax_internet/consultaBoletim.do?method=gerarCSVFechamentoMoedaNoPeriodo&amp;ChkMoeda=61&amp;DATAINI=14/04/2021&amp;DATAFIM=15/04/2021">https://ptax.bcb.gov.br/ptax_internet/consultaBoletim.do?method=gerarCSVFechamentoMoedaNoPeriodo&amp;ChkMoeda=61&amp;DATAINI=14/04/2021&amp;DATAFIM=15/04/2021</a>. <code>DATAINI</code> means start date, and <code>DATAFIM</code> end date.</p>
<p>Now, to import the exchange rates from CSV. Here comes the main difference between Google sheets and Excel. Google sheets provide a very nice <code>IMPORTDATA</code> function that works directly in the sheet, while Excel has no such thing. There&rsquo;s all the data importing, scrapping and processing tools that come together with Power Query, so I had to use the UI a bit.</p>
<p><img src="https://media.giphy.com/media/l0EtMMARnUBHCzZ3G/giphy.gif" alt="Mr. Krabs agreeing to something. He looks happy."></p>
<p>I find this the easiest way to create the connection: import the CSV using the <strong>Data</strong> tab in Excel, and then change the connection to be a function. You can process the origin CSV manually to remove all columns except the one for the exchange rate, and have only the last row to be shown, or use the function I have created:</p>
<pre tabindex="0"><code>= (URL) as table =&gt;

let
    Source = Csv.Document(Web.Contents(URL),[Delimiter=&quot;;&quot;, Columns=8, Encoding=1252, QuoteStyle=QuoteStyle.None]),
    #&quot;Sorted Rows&quot; = Table.Sort(Source,{{&quot;Column1&quot;, Order.Descending}}),
    #&quot;Removed Columns&quot; = Table.RemoveColumns(#&quot;Sorted Rows&quot;,{&quot;Column1&quot;, &quot;Column2&quot;, &quot;Column3&quot;, &quot;Column4&quot;, &quot;Column6&quot;, &quot;Column7&quot;, &quot;Column8&quot;}),&gt; 
    #&quot;Kept First Rows&quot; = Table.FirstN(#&quot;Removed Columns&quot;,1),
    #&quot;Renamed Columns&quot; = Table.RenameColumns(#&quot;Kept First Rows&quot;,{{&quot;Column5&quot;, &quot;1 USD em BRL&quot;}})
in
    #&quot;Changed Type&quot;
</code></pre><p>There&rsquo;s a <code>URL</code> parameter the function will take into account. You can invoke the function directly, provide the URL and get the rate, or you can create a table and invoke the custom function (as I did).</p>
<p>Here&rsquo;s the <a href="https://github.com/mirianbr/exchange-rates/blob/main/Exchange_rates-PQ-en-rev2.xlsx">resulting Excel sheet</a> (<a href="https://github.com/mirianbr/exchange-rates/blob/main/Exchange_rates-PQ-ptBR-v2.xlsx">pt-BR version</a>). You can download, use, change and improve it freely.</p>
<p>I&rsquo;m sure there are so many ways to do this better, and I&rsquo;d love to hear any comments or suggestions you may have - please see <a href="https://mirianbr.github.io/">my contacts</a> and let&rsquo;s chat!</p>
<p><img src="https://media.giphy.com/media/WhwzCRKKs1yDe/giphy.gif" alt="Cute little kittens using headsets and telephones"></p>
]]></content>
        </item>
        
        <item>
            <title>First title</title>
            <link>https://mirianbr.com/posts/2021-07-07-my-first-blog-post/</link>
            <pubDate>Wed, 07 Jul 2021 00:00:00 +0000</pubDate>
            
            <guid>https://mirianbr.com/posts/2021-07-07-my-first-blog-post/</guid>
            <description>First post!</description>
            <content type="html"><![CDATA[<p>First post!</p>
]]></content>
        </item>
        
    </channel>
</rss>
